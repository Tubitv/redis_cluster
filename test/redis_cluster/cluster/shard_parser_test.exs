defmodule RedisCluster.Cluster.ShardParserTest do
  use ExUnit.Case, async: true

  alias RedisCluster.Cluster.ShardParser
  alias RedisCluster.Cluster.NodeInfo

  test "should parse the output of the CLUSTER SHARDS command without fragmented nodes" do
    result =
      basic_data()
      |> ShardParser.parse()
      |> NodeInfo.to_table()
      |> IO.iodata_to_binary()

    expected =
      String.trim_trailing("""
      Slot Start | Slot End | Host      | Port | Role   
      ---------- | -------- | --------- | ---- | -------
      0          | 5460     | 127.0.0.1 | 6379 | master 
      0          | 5460     | 127.0.0.1 | 6383 | replica
      0          | 5460     | 127.0.0.1 | 6384 | replica
      0          | 5460     | 127.0.0.1 | 6389 | replica
      5461       | 10922    | 127.0.0.1 | 6380 | master 
      5461       | 10922    | 127.0.0.1 | 6382 | replica
      5461       | 10922    | 127.0.0.1 | 6385 | replica
      5461       | 10922    | 127.0.0.1 | 6386 | replica
      10923      | 16383    | 127.0.0.1 | 6381 | master 
      10923      | 16383    | 127.0.0.1 | 6387 | replica
      10923      | 16383    | 127.0.0.1 | 6388 | replica
      10923      | 16383    | 127.0.0.1 | 6390 | replica
      """)

    assert result == expected
  end

  test "should parse the output of the CLUSTER SHARDS command with fragmented nodes" do
    result =
      fragmented_data()
      |> ShardParser.parse()
      |> NodeInfo.to_table()
      |> IO.iodata_to_binary()
      |> String.trim_trailing()

    expected =
      String.trim_trailing("""
      Slot Start | Slot End | Host          | Port | Role   
      ---------- | -------- | ------------- | ---- | -------
      0          | 682      | 172.40.36.0   | 6379 | replica
      0          | 682      | 172.40.62.232 | 6379 | master 
      683        | 1365     | 172.40.26.169 | 6379 | replica
      683        | 1365     | 172.40.33.81  | 6379 | master 
      1366       | 1487     | 172.40.28.245 | 6379 | master 
      1366       | 1487     | 172.40.37.252 | 6379 | replica
      1488       | 2170     | 172.40.28.242 | 6379 | master 
      1488       | 2170     | 172.40.49.97  | 6379 | replica
      2171       | 2731     | 172.40.28.245 | 6379 | master 
      2171       | 2731     | 172.40.37.252 | 6379 | replica
      2732       | 3414     | 172.40.37.251 | 6379 | replica
      2732       | 3414     | 172.40.55.182 | 6379 | master 
      3415       | 4097     | 172.40.20.19  | 6379 | replica
      3415       | 4097     | 172.40.36.160 | 6379 | master 
      4098       | 4780     | 172.40.17.44  | 6379 | replica
      4098       | 4780     | 172.40.61.204 | 6379 | master 
      4781       | 5463     | 172.40.28.182 | 6379 | replica
      4781       | 5463     | 172.40.33.206 | 6379 | master 
      5464       | 6146     | 172.40.27.209 | 6379 | master 
      5464       | 6146     | 172.40.33.178 | 6379 | replica
      6147       | 6828     | 172.40.39.132 | 6379 | master 
      6147       | 6828     | 172.40.61.88  | 6379 | replica
      6829       | 7511     | 172.40.20.92  | 6379 | master 
      6829       | 7511     | 172.40.43.135 | 6379 | replica
      7512       | 8193     | 172.40.27.69  | 6379 | master 
      7512       | 8193     | 172.40.53.20  | 6379 | replica
      8194       | 8875     | 172.40.43.186 | 6379 | master 
      8194       | 8875     | 172.40.53.16  | 6379 | replica
      8876       | 9558     | 172.40.23.25  | 6379 | master 
      8876       | 9558     | 172.40.46.1   | 6379 | replica
      9559       | 10240    | 172.40.24.58  | 6379 | master 
      9559       | 10240    | 172.40.59.37  | 6379 | replica
      10241      | 10923    | 172.40.19.190 | 6379 | master 
      10241      | 10923    | 172.40.42.5   | 6379 | replica
      10924      | 11605    | 172.40.35.244 | 6379 | master 
      10924      | 11605    | 172.40.57.45  | 6379 | replica
      11606      | 12288    | 172.40.26.238 | 6379 | replica
      11606      | 12288    | 172.40.46.24  | 6379 | master 
      12289      | 12340    | 172.40.27.199 | 6379 | master 
      12289      | 12340    | 172.40.39.242 | 6379 | replica
      12341      | 13022    | 172.40.18.240 | 6379 | replica
      12341      | 13022    | 172.40.48.69  | 6379 | master 
      13023      | 13653    | 172.40.27.199 | 6379 | master 
      13023      | 13653    | 172.40.39.242 | 6379 | replica
      13654      | 14335    | 172.40.38.179 | 6379 | replica
      13654      | 14335    | 172.40.63.119 | 6379 | master 
      14336      | 15018    | 172.40.27.36  | 6379 | replica
      14336      | 15018    | 172.40.44.147 | 6379 | master 
      15019      | 15620    | 172.40.31.18  | 6379 | replica
      15019      | 15620    | 172.40.39.217 | 6379 | master 
      15621      | 16302    | 172.40.31.88  | 6379 | master 
      15621      | 16302    | 172.40.54.19  | 6379 | replica
      16303      | 16383    | 172.40.31.18  | 6379 | replica
      16303      | 16383    | 172.40.39.217 | 6379 | master
      """)

    assert result == expected
  end

  defp basic_data() do
    [
      [
        "slots",
        [5461, 10922],
        "nodes",
        [
          [
            "id",
            "303a39cc55db216e49b417d46e8fe4a32e30c783",
            "port",
            6380,
            "ip",
            "127.0.0.1",
            "endpoint",
            "127.0.0.1",
            "role",
            "master",
            "replication-offset",
            15402,
            "health",
            "online"
          ],
          [
            "id",
            "b97be4cf4d1dd22404127b11e4f5da71914c28cf",
            "port",
            6386,
            "ip",
            "127.0.0.1",
            "endpoint",
            "127.0.0.1",
            "role",
            "replica",
            "replication-offset",
            15402,
            "health",
            "online"
          ],
          [
            "id",
            "38c2c740ef09d23beff1d9042e9f379fa3283f66",
            "port",
            6382,
            "ip",
            "127.0.0.1",
            "endpoint",
            "127.0.0.1",
            "role",
            "replica",
            "replication-offset",
            15388,
            "health",
            "online"
          ],
          [
            "id",
            "93ca1f57cfd0fea36dd77112004e3ec0e6d39dfe",
            "port",
            6385,
            "ip",
            "127.0.0.1",
            "endpoint",
            "127.0.0.1",
            "role",
            "replica",
            "replication-offset",
            15402,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [10923, 16383],
        "nodes",
        [
          [
            "id",
            "1801cc5f427b6aeea863303cb2d7ece98db4ae1d",
            "port",
            6381,
            "ip",
            "127.0.0.1",
            "endpoint",
            "127.0.0.1",
            "role",
            "master",
            "replication-offset",
            9_458_959,
            "health",
            "online"
          ],
          [
            "id",
            "84ec29261ddb384ab0967a6bdfccabcbda67a6ad",
            "port",
            6388,
            "ip",
            "127.0.0.1",
            "endpoint",
            "127.0.0.1",
            "role",
            "replica",
            "replication-offset",
            9_458_959,
            "health",
            "online"
          ],
          [
            "id",
            "00a722cd4715290b8fd45fe06a73502d9b3fc06d",
            "port",
            6390,
            "ip",
            "127.0.0.1",
            "endpoint",
            "127.0.0.1",
            "role",
            "replica",
            "replication-offset",
            9_458_959,
            "health",
            "online"
          ],
          [
            "id",
            "66d0470b1a5391208fa9e6c358bc75ebf9d377bf",
            "port",
            6387,
            "ip",
            "127.0.0.1",
            "endpoint",
            "127.0.0.1",
            "role",
            "replica",
            "replication-offset",
            9_458_959,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [0, 5460],
        "nodes",
        [
          [
            "id",
            "bc169eaf5f94bf1a6a0acfbd9586c492e40c4304",
            "port",
            6379,
            "ip",
            "127.0.0.1",
            "endpoint",
            "127.0.0.1",
            "role",
            "master",
            "replication-offset",
            13386,
            "health",
            "online"
          ],
          [
            "id",
            "bfe62c63cc9c2658f0ecb4e73b7ca08a977718e5",
            "port",
            6383,
            "ip",
            "127.0.0.1",
            "endpoint",
            "127.0.0.1",
            "role",
            "replica",
            "replication-offset",
            13386,
            "health",
            "online"
          ],
          [
            "id",
            "2cb2c73b0893918e8489fc2f0d386ec39e16b5b9",
            "port",
            6389,
            "ip",
            "127.0.0.1",
            "endpoint",
            "127.0.0.1",
            "role",
            "replica",
            "replication-offset",
            13386,
            "health",
            "online"
          ],
          [
            "id",
            "a1e434afc228a4e98f08529ae4854f19e123862e",
            "port",
            6384,
            "ip",
            "127.0.0.1",
            "endpoint",
            "127.0.0.1",
            "role",
            "replica",
            "replication-offset",
            13372,
            "health",
            "online"
          ]
        ]
      ]
    ]
  end

  defp fragmented_data() do
    [
      [
        "slots",
        [4781, 5463],
        "nodes",
        [
          [
            "id",
            "f04b3eddfd1cda448b000e540eefd7977f1a3995",
            "port",
            6379,
            "ip",
            "172.40.33.206",
            "endpoint",
            "test-redis4-0004-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0004-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            123_428_151_759,
            "health",
            "online"
          ],
          [
            "id",
            "af8f0cc54b8e1a2ae33f3743bb9154e42d09979f",
            "port",
            6379,
            "ip",
            "172.40.28.182",
            "endpoint",
            "test-redis4-0004-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0004-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            123_428_167_428,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [6829, 7511],
        "nodes",
        [
          [
            "id",
            "d60a5cf69ff85d1d88b43dc9d6f748638ef7bf2a",
            "port",
            6379,
            "ip",
            "172.40.20.92",
            "endpoint",
            "test-redis4-0006-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0006-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            123_427_450_269,
            "health",
            "online"
          ],
          [
            "id",
            "121570004d9fdf7955b108941072efc016610ac7",
            "port",
            6379,
            "ip",
            "172.40.43.135",
            "endpoint",
            "test-redis4-0006-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0006-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            123_427_470_349,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [4098, 4780],
        "nodes",
        [
          [
            "id",
            "06ead0643819963959dfdb6bad0295ee9bc604fe",
            "port",
            6379,
            "ip",
            "172.40.61.204",
            "endpoint",
            "test-redis4-0016-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0016-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            14_659_224_511,
            "health",
            "online"
          ],
          [
            "id",
            "ffea41a4a4ba7e74299b81045cef7be3b69aa1fc",
            "port",
            6379,
            "ip",
            "172.40.17.44",
            "endpoint",
            "test-redis4-0016-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0016-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            14_659_223_117,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [6147, 6828],
        "nodes",
        [
          [
            "id",
            "762eba16fe8c95f046f028f9b3b92f086d08cc43",
            "port",
            6379,
            "ip",
            "172.40.39.132",
            "endpoint",
            "test-redis4-0017-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0017-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            14_842_101_742,
            "health",
            "online"
          ],
          [
            "id",
            "c809fff4f46fac2633e206c60341f29cfefce49e",
            "port",
            6379,
            "ip",
            "172.40.61.88",
            "endpoint",
            "test-redis4-0017-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0017-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            14_842_109_226,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [11606, 12288],
        "nodes",
        [
          [
            "id",
            "02ff27163ecb22760add0190cb2c5397bfa0b7cb",
            "port",
            6379,
            "ip",
            "172.40.46.24",
            "endpoint",
            "test-redis4-0009-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0009-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            124_305_672_703,
            "health",
            "online"
          ],
          [
            "id",
            "158ca798f63eb2cc72c3d7488f62dc9de9efcecd",
            "port",
            6379,
            "ip",
            "172.40.26.238",
            "endpoint",
            "test-redis4-0009-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0009-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            124_305_672_916,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [9559, 10240],
        "nodes",
        [
          [
            "id",
            "ef6ba8900cd63fad010a9f3e44eb7a08a82f8d67",
            "port",
            6379,
            "ip",
            "172.40.24.58",
            "endpoint",
            "test-redis4-0020-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0020-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            14_988_848_825,
            "health",
            "online"
          ],
          [
            "id",
            "476e1628138b834a61808eafc8dd721a71e27500",
            "port",
            6379,
            "ip",
            "172.40.59.37",
            "endpoint",
            "test-redis4-0020-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0020-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            14_988_846_507,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [3415, 4097],
        "nodes",
        [
          [
            "id",
            "beec7914066dd6be71ffed74eeb30bb99eb73850",
            "port",
            6379,
            "ip",
            "172.40.36.160",
            "endpoint",
            "test-redis4-0003-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0003-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            131_440_995_502,
            "health",
            "online"
          ],
          [
            "id",
            "e9881e7ff1fd9d4c16229e3a7f0a08fceda07dd2",
            "port",
            6379,
            "ip",
            "172.40.20.19",
            "endpoint",
            "test-redis4-0003-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0003-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            131_440_995_222,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [10241, 10923],
        "nodes",
        [
          [
            "id",
            "44a88d0b4f3b7cb738f7d3558c6b1bc07b209419",
            "port",
            6379,
            "ip",
            "172.40.19.190",
            "endpoint",
            "test-redis4-0008-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0008-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            123_565_816_122,
            "health",
            "online"
          ],
          [
            "id",
            "79ed57dc0fd145f65145b856e793688f1e52825f",
            "port",
            6379,
            "ip",
            "172.40.42.5",
            "endpoint",
            "test-redis4-0008-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0008-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            123_565_816_122,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [1366, 1487, 2171, 2731],
        "nodes",
        [
          [
            "id",
            "198801cdd9c601c971ecf07de3b6e9b819386137",
            "port",
            6379,
            "ip",
            "172.40.28.245",
            "endpoint",
            "test-redis4-0002-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0002-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            122_785_773_924,
            "health",
            "online"
          ],
          [
            "id",
            "0d7bdbda3b59748756aff05f096c2901a8ad51ab",
            "port",
            6379,
            "ip",
            "172.40.37.252",
            "endpoint",
            "test-redis4-0002-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0002-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            122_785_772_755,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [8876, 9558],
        "nodes",
        [
          [
            "id",
            "0f492b2573fb355e784601712593683fd486823e",
            "port",
            6379,
            "ip",
            "172.40.23.25",
            "endpoint",
            "test-redis4-0007-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0007-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            121_669_414_018,
            "health",
            "online"
          ],
          [
            "id",
            "528a022402240f8e56914827d3be53367117cf39",
            "port",
            6379,
            "ip",
            "172.40.46.1",
            "endpoint",
            "test-redis4-0007-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0007-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            121_669_419_805,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [8194, 8875],
        "nodes",
        [
          [
            "id",
            "6f7de9cf825b2effa0e0af1ee254cccd33031871",
            "port",
            6379,
            "ip",
            "172.40.43.186",
            "endpoint",
            "test-redis4-0019-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0019-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            14_796_714_907,
            "health",
            "online"
          ],
          [
            "id",
            "f0e57bf42d652689f660261765b869a185c48c6a",
            "port",
            6379,
            "ip",
            "172.40.53.16",
            "endpoint",
            "test-redis4-0019-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0019-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            14_796_727_407,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [12289, 12340, 13023, 13653],
        "nodes",
        [
          [
            "id",
            "8db52aeddb6e84253c7a2f25483cffdd8e0e1dda",
            "port",
            6379,
            "ip",
            "172.40.27.199",
            "endpoint",
            "test-redis4-0010-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0010-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            123_586_637_486,
            "health",
            "online"
          ],
          [
            "id",
            "e876fac2eb783410dc8d9041a0e53143caf4e6e4",
            "port",
            6379,
            "ip",
            "172.40.39.242",
            "endpoint",
            "test-redis4-0010-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0010-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            123_586_622_458,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [7512, 8193],
        "nodes",
        [
          [
            "id",
            "93f73800619216da581e37165bbbb6b7c60af41f",
            "port",
            6379,
            "ip",
            "172.40.27.69",
            "endpoint",
            "test-redis4-0018-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0018-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            16_594_477_142,
            "health",
            "online"
          ],
          [
            "id",
            "26ffbb81af26d3edc189a7d65592bcbb6fd4c303",
            "port",
            6379,
            "ip",
            "172.40.53.20",
            "endpoint",
            "test-redis4-0018-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0018-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            16_594_480_346,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [12341, 13022],
        "nodes",
        [
          [
            "id",
            "3d2f0318fbe740fd6a930cbd0aac50348422d7bf",
            "port",
            6379,
            "ip",
            "172.40.48.69",
            "endpoint",
            "test-redis4-0022-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0022-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            14_640_052_970,
            "health",
            "online"
          ],
          [
            "id",
            "c410edc4a23dda69b7b3a698d46fce3d85573dce",
            "port",
            6379,
            "ip",
            "172.40.18.240",
            "endpoint",
            "test-redis4-0022-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0022-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            14_640_064_307,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [15019, 15620, 16303, 16383],
        "nodes",
        [
          [
            "id",
            "a9b722d9b78b135d2dfadb5f46d7572413de577a",
            "port",
            6379,
            "ip",
            "172.40.39.217",
            "endpoint",
            "test-redis4-0012-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0012-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            123_216_628_983,
            "health",
            "online"
          ],
          [
            "id",
            "b2b902de28e7bc2aba4444477b3c7e3ffaf27120",
            "port",
            6379,
            "ip",
            "172.40.31.18",
            "endpoint",
            "test-redis4-0012-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0012-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            123_216_628_077,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [10924, 11605],
        "nodes",
        [
          [
            "id",
            "66bbd1d85fd3ebfc3ce85d97beaad35d49341819",
            "port",
            6379,
            "ip",
            "172.40.35.244",
            "endpoint",
            "test-redis4-0021-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0021-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            15_015_548_933,
            "health",
            "online"
          ],
          [
            "id",
            "c5f9f2a6c8dc19c23f39b13568a2ad06fbe3b714",
            "port",
            6379,
            "ip",
            "172.40.57.45",
            "endpoint",
            "test-redis4-0021-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0021-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            15_015_543_304,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [5464, 6146],
        "nodes",
        [
          [
            "id",
            "85d20bb52b42d1e3a3d207d86a673663d389fbd4",
            "port",
            6379,
            "ip",
            "172.40.27.209",
            "endpoint",
            "test-redis4-0005-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0005-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            126_036_707_049,
            "health",
            "online"
          ],
          [
            "id",
            "a24b0c7345920e0e4edbc18414446724073d3ac9",
            "port",
            6379,
            "ip",
            "172.40.33.178",
            "endpoint",
            "test-redis4-0005-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0005-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            126_036_702_416,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [1488, 2170],
        "nodes",
        [
          [
            "id",
            "2bca81e0f3a70394a50a9090c32c04f4833d29c3",
            "port",
            6379,
            "ip",
            "172.40.28.242",
            "endpoint",
            "test-redis4-0014-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0014-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            14_778_722_189,
            "health",
            "online"
          ],
          [
            "id",
            "ccf7896b74baad0566b51b23417f4058d91fd38d",
            "port",
            6379,
            "ip",
            "172.40.49.97",
            "endpoint",
            "test-redis4-0014-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0014-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            14_778_722_029,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [14336, 15018],
        "nodes",
        [
          [
            "id",
            "ed7d2ba82050c48a0d3f62ea09081b3a232e9061",
            "port",
            6379,
            "ip",
            "172.40.44.147",
            "endpoint",
            "test-redis4-0011-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0011-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            122_184_820_916,
            "health",
            "online"
          ],
          [
            "id",
            "22a90411dbf9f939f4e1e81db953e95d6af42bc2",
            "port",
            6379,
            "ip",
            "172.40.27.36",
            "endpoint",
            "test-redis4-0011-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0011-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            122_184_820_794,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [15621, 16302],
        "nodes",
        [
          [
            "id",
            "b233edf38a1afed6a8a595d4c4ce1d694a93e428",
            "port",
            6379,
            "ip",
            "172.40.31.88",
            "endpoint",
            "test-redis4-0024-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0024-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            14_710_275_627,
            "health",
            "online"
          ],
          [
            "id",
            "83c873aeee139f4e30c9c4a2d33dea0cfefe54b1",
            "port",
            6379,
            "ip",
            "172.40.54.19",
            "endpoint",
            "test-redis4-0024-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0024-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            14_710_293_198,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [13654, 14335],
        "nodes",
        [
          [
            "id",
            "38ab9ab762206ef8144b17ff43e604a4618567e0",
            "port",
            6379,
            "ip",
            "172.40.63.119",
            "endpoint",
            "test-redis4-0023-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0023-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            15_058_489_519,
            "health",
            "online"
          ],
          [
            "id",
            "b914d3b8eaae2840b6301dc47432cf9c766adee9",
            "port",
            6379,
            "ip",
            "172.40.38.179",
            "endpoint",
            "test-redis4-0023-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0023-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            15_058_496_501,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [2732, 3414],
        "nodes",
        [
          [
            "id",
            "e42f33131c63f51590cae8038130c441a8693da1",
            "port",
            6379,
            "ip",
            "172.40.55.182",
            "endpoint",
            "test-redis4-0015-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0015-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            14_934_648_145,
            "health",
            "online"
          ],
          [
            "id",
            "51bc65d76982445caa6828bcdd446963669201ee",
            "port",
            6379,
            "ip",
            "172.40.37.251",
            "endpoint",
            "test-redis4-0015-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0015-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            14_934_651_321,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [0, 682],
        "nodes",
        [
          [
            "id",
            "3a01dcc3b30d3177e70a7778983733354fde3f02",
            "port",
            6379,
            "ip",
            "172.40.62.232",
            "endpoint",
            "test-redis4-0013-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0013-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            14_938_686_418,
            "health",
            "online"
          ],
          [
            "id",
            "1059d09031eadda7b83571763bd77ffdd8b7816a",
            "port",
            6379,
            "ip",
            "172.40.36.0",
            "endpoint",
            "test-redis4-0013-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0013-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            14_938_678_986,
            "health",
            "online"
          ]
        ]
      ],
      [
        "slots",
        [683, 1365],
        "nodes",
        [
          [
            "id",
            "364c32b7731bcadb23d9582b8346ce5b56955b20",
            "port",
            6379,
            "ip",
            "172.40.33.81",
            "endpoint",
            "test-redis4-0001-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0001-001.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "master",
            "replication-offset",
            123_035_111_106,
            "health",
            "online"
          ],
          [
            "id",
            "0a0464f5fd4e2815acbcedad145bf8f3606f6653",
            "port",
            6379,
            "ip",
            "172.40.26.169",
            "endpoint",
            "test-redis4-0001-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "hostname",
            "test-redis4-0001-002.test-redis4.abcdef.usw2.cache.amazonaws.com",
            "role",
            "replica",
            "replication-offset",
            123_035_110_772,
            "health",
            "online"
          ]
        ]
      ]
    ]
  end
end
